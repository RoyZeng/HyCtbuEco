@{
    ViewBag.Title = "长江上游地区经济社会发展数据库";
    Layout = null;

}

<!DOCTYPE html>
<html lang="en-us" id="extr-page">
<head>
    <meta charset="utf-8">
    <title>长江上游地区经济社会发展数据库--系统用户</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- #CSS Links -->
    <!-- Basic Styles -->
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/font-awesome.min.css">

    <!-- SmartAdmin Styles : Caution! DO NOT change the order -->
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/smartadmin-production-plugins.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/smartadmin-production.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/smartadmin-skins.min.css">

    <!-- SmartAdmin RTL Support -->
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/smartadmin-rtl.min.css">



    <!-- Demo purpose only: goes with demo.js, you can delete this css when designing your own WebApp -->
    <link rel="stylesheet" type="text/css" media="screen" href="~/css/demo.min.css">

    <!-- #FAVICONS -->
    <link rel="shortcut icon" href="~/img/favicon/favicon.ico" type="image/x-icon">
    <link rel="icon" href="~/img/favicon/favicon.ico" type="image/x-icon">


    <link rel="apple-touch-icon" href="~/img/splash/sptouch-icon-iphone.png">
    <link rel="apple-touch-icon" sizes="76x76" href="~/img/splash/touch-icon-ipad.png">
    <link rel="apple-touch-icon" sizes="120x120" href="~/img/splash/touch-icon-iphone-retina.png">
    <link rel="apple-touch-icon" sizes="152x152" href="~/img/splash/touch-icon-ipad-retina.png">

    <!-- iOS web-app metas : hides Safari UI Components and Changes Status Bar Appearance -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <!-- Startup image for web apps -->
    <link rel="apple-touch-startup-image" href="~/img/splash/ipad-landscape.png" media="screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:landscape)">
    <link rel="apple-touch-startup-image" href="~/img/splash/ipad-portrait.png" media="screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:portrait)">
    <link rel="apple-touch-startup-image" href="~/img/splash/iphone.png" media="screen and (max-device-width: 320px)">


    <style type="text/css">


        #header {
            padding: 0px !important;
        }

        div.headerBak {
            background-image: url(/img/home/middle.png);
            width: 100% !important;
            height: 100% !important;
        }


        #extr-page #header #logo {
            color: #fff;
            font-family: Arial,"汉仪行楷简";
            font-size: 30px;
            font-weight: bold;
            margin-left: 100px;
            margin-top: 5px;
            width: 1300px;
            letter-spacing: 5px;
        }


        .smart-form footer {
            padding: 0 5px 5px;
        }


        footer.footer {
            background-image: url(/img/home/middle.png);
        }

        .list-inline > li {
            color: #fff;
            font-size: 16px;
            font-weight: 500;
            margin-top: 4px;
        }
        #extr-page #main {
            padding-top: 10px;
        }

    </style>

</head>

<body class="animated fadeInDown">

    <header id="header">
        <div class="headerBak">
            <div id="logo-group">
                <div id="logo">
                    <img src="~/img/home/LOGO.png" alt="长江上游经济研究中心" style="width: 90px; height: 85px;margin-bottom:55px;">
                    <div style="display:inline-block">
                        <span>重庆工商大学长江上游经济研究中心</span><br />
                        <span style="margin-left:350px">长江上游地区经济社会发展数据库</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <div id="main" role="main">

        <!-- MAIN CONTENT -->
        <div id="content" class="container">

            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-7 col-lg-8 hidden-xs hidden-sm">
                    <h1 class="txt-color-red login-header-big">长江上游经济研究中心</h1>
                    <div class="hero">
                        <img src="~/img/home/head.jpg" style="width:80%;height:60%" />
                        @*<div class="pull-left login-desc-box-l">
                            <h4 class="paragraph-header">长江上游经济研究中心!</h4>

                        </div>

                        <img src="~/img/demo/iphoneview.png" class="pull-right display-image" alt="" style="width: 210px">*@
                    </div>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4">
                    <div class="well no-padding">
                        <form id="login-form" class="smart-form client-form" action="/WebApi/SysManager/SysUser">
                            <header>
                                登录
                            </header>

                            <fieldset>

                                <section>
                                    <label class="label">用户名:</label>
                                    <label class="input">
                                        <i class="icon-append fa fa-user"></i>
                                        <input id="txt_loginName" name="txt_loginName">
                                        <b class="tooltip tooltip-top-right"><i class="fa fa-user txt-color-teal"></i>请输入用户名</b></label>
                                    <p class="help-block">请输入登录名,必填</p>
                                </section>

                                <section>
                                    <label class="label">密码:</label>
                                    <label class="input">
                                        <i class="icon-append fa fa-lock"></i>
                                        <input type="password" name="txt_password" id="txt_password">
                                        <b class="tooltip tooltip-top-right"><i class="fa fa-lock txt-color-teal"></i>请输入密码</b>
                                    </label>
                                    <p class="help-block">请输入密码,必填</p>

                                </section>

                                <section>
                                    <label class="label">验证码</label>
                                    <label class="input">
                                        <input type="text" placeholder="请输入下方验证码" id="txt_validation" name="txt_validation">
                                    </label>
                                    <div class="row-fluid val">
                                        <img id="valiCode" style="cursor: pointer;" src="/Login/GetValidateCode" alt="验证码" title="点我刷新" onclick="ClickRemoveChangeCode()" />
                                    </div>
                                </section>

                            </fieldset>
                            <footer>
                                <button type="submit" class="btn btn-primary" onclick="login();return false;">
                                    登录
                                </button>
                            </footer>
                        </form>

                    </div>



                </div>
            </div>
        </div>

    </div>


    <footer class="footer ">
        <div class="container">

            <div class="row footer-bottom">
                <ul class="list-inline text-center">
                    <li>Copyright © 2015 长江上游经济研究中心 建议使用浏览器：IE9.0+、Google Chrome、Mozilla Firefox</li>
                </ul>
            </div>
        </div>
    </footer>

    <!--================================================== -->

    <!-- PACE LOADER - turn this on if you want ajax loading to show (caution: uses lots of memory on iDevices)-->
    <script src="~/js/plugin/pace/pace.min.js"></script>

    <!-- Link to Google CDN's jQuery + jQueryUI; fall back to local -->
    <script> if (!window.jQuery) { document.write('<script src="~/js/libs/jquery-2.1.1.min.js"><\/script>'); } </script>

    @*<script> if (!window.jQuery.ui) { document.write('<script src="~/js/libs/jquery-ui-1.10.3.min.js"><\/script>'); } </script>*@

    <!--jQueryUI.js-->
    <script src="~/js/libs/jquery-ui-1.10.3.min.js"></script>
    <!-- IMPORTANT: APP CONFIG -->
    <script src="~/js/app.config.js"></script>

    <!-- JS TOUCH : include this plugin for mobile drag / drop touch events 		
		<script src="js/plugin/jquery-touch/jquery.ui.touch-punch.min.js"></script> -->

    <!-- BOOTSTRAP JS -->
    <script src="~/js/bootstrap/bootstrap.min.js"></script>

    <!-- JQUERY VALIDATE -->
    <script src="~/js/plugin/jquery-validate/jquery.validate.min.js"></script>

    <!-- JQUERY MASKED INPUT -->
    <script src="~/js/plugin/masked-input/jquery.maskedinput.min.js"></script>

    <!--knockout.js-->
    <script src="~/js/knockout-3.3.0.js"></script>

    <!--[if IE 8]>
			
			<h1>Your browser is out of date, please update your browser by going to www.microsoft.com/download</h1>
			
		<![endif]-->

    <!-- MAIN APP JS FILE -->
    <script src="~/js/app.js"></script>

    <script type="text/javascript">
        runAllForms();
        //单击重新改变验证码
        function ClickRemoveChangeCode() {
            var code = $("#valiCode").attr("src");
            var url=code.split('?');
            code=url[0]+"?ID="+randomString();
            $("#valiCode").attr("src", code );
        }

        function randomString(len) {
            len = len || 10;
            var $chars = 'ABC1DEFGH2IJK3LMNOQP4RSTU5VWXYZab6cdef8ghij7kmlnopq9rest0uvwxyz';
            var maxPos = $chars.length;
            var pwd = '';
            for (i = 0; i < len; i++) {
                pwd += $chars.charAt(Math.floor(Math.random() * maxPos));
            }
            return pwd;
        }


        $(function () {
            $("body").keypress(function (event) {
                if (event.keyCode == 13) {
                    login();
                }
            });
            // Validation
            $("#login-form").validate({
                // Rules for form validation
                rules:
                    {
                        txt_loginName: { required: true },
                        txt_password: { required: true },
                        txt_validation: { required: true }
                    },
                messages:
                    {
                        txt_loginName: { required: "用户名不能为空", },
                        txt_password: { required: "密码不能为空" },
                        txt_validation: { required: "验证码不能为空" }
                    },

                // Do not change code below
                errorPlacement: function (error, element) {
                    error.insertAfter(element.parent());
                }
            });
        });

        function login() {
            if ($("#login-form").valid()) {
                var loginName = $("#txt_loginName").val();
                var password = $("#txt_password").val();   //登录用户的密码
                var validcode = $("#txt_validation").val();
               
                $.ajax({
                    url: '/WebApi/LoginValidate/SysUser',
                    type: 'POST',
                    cache: false,
                    data: { UserName: loginName, PassWord: password, valide: validcode },
                    success: function (resultObj) {
                        var result=resultObj.rs;
                        var url=resultObj.mainURL;

                        switch (result) {
                            case 1:
                                location.href = url;

                                break;
                            case 0:
                                alert("错误的用户名或密码!");
                                break;
                            case -1:
                                alert("非法参数!");
                                break;
                            case -2:
                                alert("验证码错误！请点击验证码图片重刷再试!");
                                break;
                            case -3:
                                alert("出错了！无法接受的用户名/密码!");
                                break;
                        }
                    }



                });
            }

        }//end login


        function cleanBind($node) {
            // unbind events
            $node.find("*").each(function () {
                $(this).unbind();
            });
            var element = $node[0];
            ko.cleanNode(element);
        }

    </script>

</body>
</html>




