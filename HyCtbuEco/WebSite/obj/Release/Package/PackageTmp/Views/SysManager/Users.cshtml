@{
    Layout = null;
}
<!--begin grid code-->

<!--Operation-->
<div class="heading-buttons">


    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark">
            <i class="fa fa-group  "></i>
            系统用户管理

        </h1>
    </div>
    <div class="buttons pull-right">

        <button type="button" class="btn btn-success btn-labeled "
            data-bind="click: $root.showAddBefore">
            <span class="btn-label">
                <i class="glyphicon glyphicon-plus"></i>
            </span>添加系统用户
        </button>

        <button type="button" class="btn btn-danger btn-labeled "
            data-bind="click: $root.onDataDeleting">
            <span class="btn-label">
                <i class="glyphicon glyphicon-remove"></i>
            </span>批量删除
        </button>


    </div>
    <div style="clear: both;">
    </div>
</div>
<!--/Operation-->

<section id="widget-grid" class="">

    <!-- Widget ID (each widget will need unique ID)-->
    <div class="jarviswidget jarviswidget-color-red" id="wid-id-Usrs" data-widget-colorbutton="false"
        data-widget-editbutton="false"
        data-widget-togglebutton="false"
        data-widget-deletebutton="false" data-widget-custombutton=" false"
        data-widget-sortable="false">

        <header>

            <span class="widget-icon"><i class="fa fa-table"></i></span>
            <h2>系统用户信息列表</h2>

        </header>

        <!-- widget div-->

        <div>


            <!-- widget content -->
            <div class="widget-body no-padding">
                <div class="widget-body-toolbar">
                    <div class="btn-group">
                        <form id="formSearch" class="form-inline" role="form">




                            <div class='form-group'>
                                <label class='control-label' for='txtbSUserName'>用户名：</label>
                                <input id='txtbSrSUserName' name='txtbSrSUserName' type='text' placeholder='用户名' class='form-control' style='width: 120px;' />
                            </div>


                            <div class='form-group'>
                                <label class='control-label' for='txtbSTrueName'>真实姓名：</label>
                                <input id='txtbSrSTrueName' name='txtbSrSTrueName' type='text' placeholder='真实姓名' class='form-control' style='width: 120px;' />
                            </div>
                            <div class="form-group">
                                <label class="control-label" for="txtbSrSRoleName">角色：</label>
                                @Html.DropDownList("txtbSrSRoleName", new SelectList(ViewBag.roleList, "SRoleName", "SRoleName"), "--请选择--", new { @class = "form-control", @style = "width: 120px;border:1px solid #cccccc" })

                            </div>


                            <button class="btn   btn-primary" data-bind="click: $root.search">
                                <i class="fa fa-search"></i>筛选
                            </button>


                        </form>
                    </div>
                </div>
                <!--end of Toolbar -->
                <div class="table-responsive">

                    <table class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th style="width: 1%">
                                    <input type="checkbox" value="0" id="headcheck" />
                                </th>
                                <!-- ko foreach: headers -->
                                <th class="center ">
                                    <a href="#" data-bind="text: displayText@*, click: $root.sort*@" style="color: black"></a>
                                    <i class="icon-circle-arrow-up" data-bind="    visible: value == $root.orderBy() && $root.isAsc()"></i>
                                    <i class="icon-circle-arrow-down" data-bind="    visible: value == $root.orderBy() && !$root.isAsc()"></i>
                                </th>

                                <!-- /ko -->
                                <th class="center" style="width: 60px">操作</th>
                            </tr>
                        </thead>
                        <!--table body(Provider list)-->
                        <tbody data-bind="foreach: recordSet">
                            <tr class="selectable" onclick="">
                                <td class="center">
                                    <input type="checkbox" name="userSelector" data-bind="value: Id" />
                                    <input type="hidden" data-bind="value: Id, attr: { id: Id }" />
                                </td>

                                <td class='center'><strong data-bind='text: SUserName'></strong></td>

                                <td class='center'><strong data-bind='text: STrueName'></strong></td>
                                <td class='center'><strong data-bind='text: Tms.formatSex(ISex)'></strong></td>
                                <td class='center'><strong data-bind='text: SPhone'></strong></td>
                                <td class='center'><strong data-bind='text: SIDCard'></strong></td>
                                <td class='center'><strong data-bind='text: SEmail'></strong></td>
                                <td class='center'><strong data-bind='text: Tms.formatNewDate(DLastLoginDate)'></strong></td>
                                <td class='center'><strong data-bind='text: SPartName'></strong></td>
                                <td class='center'><strong data-bind='text: SRoleName'></strong></td>

                                <td class="center">
                                    <a href="#" class="btn btn-sm btn-success" data-bind="click: $root.showUpdateModal">
                                        <i><span class="fa fa-pencil"></span></i>
                                    </a>
                                </td>
                            </tr>
                        </tbody>
                        <!--/table body( Provider list)-->
                    </table>

                </div>
                <!--end of table grid -->

                <div class="widget-footer">

                    <!-- 分页 -->
                    <ul class="pagination pagination-sm">
                        <li>
                            <a data-bind="click: firstPage"><i class="fa fa-fast-backward "></i></a>
                        </li>
                        <li class="paginate_button ">
                            <a data-bind="click: prevPage"><i class="fa  fa-backward  "></i></a>
                        </li>
                        <li class="paginate_button ">
                            <a style="padding: 2px 1px;">
                                <input id="toPageaaa" type="text" data-bind="value: pageIndex, event: { change: $root.changePageIndex }" style="width: 25px;" /></a>

                        </li>
                        <li class="paginate_button ">
                            <a>/共<span data-bind="html: totalPages"></span>页
                            </a>
                        </li>
                        <li class="paginate_button ">
                            <a data-bind="click: nextPage"><i class="fa fa-forward "></i></a>
                        </li>
                        <li class="paginate_button ">
                            <a data-bind="click: lastPage"><i class="fa fa-fast-forward "></i></a>
                        </li>
                    </ul>

                    <div class="dt-top-row total pull-left " style="margin: 18px;">
                        当前记录共：<span data-bind="html: totalCount"></span>条
                    </div>
                    <!--end 分页-->
                </div>

                <!--end of table pager -->



            </div>
            <!-- end widget content -->

        </div>
        <!-- end widget div -->

    </div>
    <!-- end widget -->


</section>


<!--SysUser详细对话框-->
<div id="SysUserMessageModal" class="modal fade" tabindex="-1" role="dialog"
    aria-labelledby="SysUserMessageModalLabel" aria-hidden="true">
    <div class="modal-dialog">

        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    ×</button>
                <h4>用户详细信息</h4>
            </div>

            <div class="modal-body">
                <ul class="nav nav-tabs bordered" id="myTab1">
                    <li class="active"><a data-toggle="tab" href="#s1">详细信息</a></li>
                    <li><a data-toggle="tab" href="#s2">设置角色</a></li>
                    <li><a data-toggle="tab" href="#s3">设置密码</a></li>
                    <li><a data-toggle="tab" href="#s4">个人介绍</a></li>
                </ul>
                <div class="tab-content padding-10" id="myTabContent1">
                    <!--详细信息-->
                    <div class="tab-pane fade in active" id="s1">
                        <div class="modal-body">
                            <input type='hidden' id='txtbID' name='txtbID' />
                            <form id="formSysUser" class="smart-form" data-bind="with: NodeValue">
                                <div class="row">
                                    <section class="col col-6">
                                        <label class="label">用户名</label>
                                        <label class="input">
                                            <input type='text' id='txtbSUserName' name='txtbSUserName' placeholder='' class='span10' data-bind='value:SUserName' onblur="UniqueUserName()" />
                                        </label>
                                    </section>
                                    <section class="col col-6">
                                        <label class="label">Email</label>
                                        <label class="input">
                                            <input type='text' id='txtbSEmail' name='txtbSEmail' placeholder='' class='span10' data-bind='value:SEmail' />
                                        </label>
                                    </section>
                                </div>
                                <div class="row">
                                    <section class="col col-6">
                                        <label class="label">真实姓名</label>
                                        <label class="input">
                                            <input type='text' id='txtbSTrueName' name='txtbSTrueName' placeholder='' class='span10' data-bind='value:STrueName' />
                                        </label>
                                    </section>

                                    <section class="col col-6">
                                        <label class="label">性别</label>
                                        <label class="select">
                                            <select class='form-control' id='txtbISex' name='txtbISex' data-bind=" options: $root.SexType, optionsText: 'name', optionsValue: 'value', value: ISex"></select>
                                        </label>
                                    </section>

                                </div>
                                <div class="row">

                                    <section class="col col-6">
                                        <label class="label">职称</label>
                                        <label class="input">
                                            <input type='text' id='txtbSPro' name='txtbSPro' placeholder='' class='span10' data-bind='value:SPro' />
                                        </label>
                                    </section>
                                    <section class="col col-6">
                                        <label class="label">所属部门</label>
                                        <label class="select">
                                            @Html.DropDownList("txtbIPart", new SelectList(ViewBag.partList, "ID", "SPartName"), "--请选择--", new { @data_bind = "value:IPart" })
                                        
                                        <i></i>
                                        </label>
                                    </section>
                                </div>

                                <div class="row">
                                    <section class="col col-6">
                                        <label class="label">联系电话</label>
                                        <label class="input">
                                            <input type='text' id='txtbSPhone' name='txtbSPhone' placeholder='' class='span10' data-bind='value:SPhone' />
                                        </label>
                                    </section>
                                    <section class="col col-6">
                                        <label class="label">传真</label>
                                        <label class="input">
                                            <input type='text' id='txtbSFax' name='txtbSFax' placeholder='' class='span10' data-bind='value:SFax' />
                                        </label>
                                    </section>
                                </div>
                                <div class="row">
                                    <section class="col col-6">
                                        <label class="label">身份证号</label>
                                        <label class="input">
                                            <input type='text' id='txtbSIDCard' name='txtbSIDCard' placeholder='' class='span10' data-bind='value:SIDCard' />
                                        </label>
                                    </section>
                                    <section class="col col-6">
                                        <label class="label">出生日期</label>
                                        <label class="input">
                                            <input type='text' id='txtbDBirth' name='txtbDBirth' placeholder='yy/mm/dd' class='span10' data-bind='value:Tms.formatDate(DBirth)' />
                                        </label>
                                    </section>
                                </div>
                                <div class="row">
                                    <section class="col col-6">
                                        <label class="label">地址</label>
                                        <label class="input">
                                            <input type='text' id='txtbSAddr' name='txtbSAddr' placeholder='' class='span10' data-bind='value:SAddr' />
                                        </label>
                                    </section>
                                     <section class="col col-6">
                                        <label class="label">默认主页</label>
                                        <label class="input">
                                            <input type='text' id='txtbSMainURL' name='txtbSMainURL' placeholder='可空，空为默认主页' class='span10' data-bind='value:SMainURL' />
                                        </label>
                                    </section>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!--角色选择-->
                    <div class="tab-pane fade in " id="s2">
                        <form class="smart-form" id="RoleSelect">
                            <fieldset>
                                <section>
                                    <div class="inline-group">

                                        @{ int roleLength = ViewBag.roleList.Count;


                                           for (int i = 0; i < roleLength; i++)
                                           {
                                               var id = @ViewBag.roleList[i].Id;
                                               var idstr = "check" + id;
                                            <label class="checkbox">
                                                <input type='checkbox' name='checkbox' id='@idstr' value='@id' />
                                                <i></i>
                                                @ViewBag.roleList[i].SRoleName
                                            </label>
                                           }
                                        }

                                    </div>
                                </section>
                                  
                                <section>
                                    <label class='control-label'>上级主管</label>
                                    <label class="input">
                                        <input type='text' id='txtbSManagerName' name='txtbSManagerName' placeholder='请输入主管姓名' class='form-control'
                                          />
                                    </label>
                                </section>

                               
                            </fieldset>
                        </form>
                    </div>

                    <!--设置密码-->
                    <div class="tab-pane fade in " id="s3">
                        <form class="smart-form" data-bind="with:NodeValue">
                            <fieldset>
                                <section>
                                    <label class='control-label'>密码<span style="color: red;">*(长度为6-20)</span></label>
                                    <label class="input">
                                        <input type="password" id='txtbSPassword' name='txtbSPassword' placeholder='' class='span10' data-bind='value:SPassword' />
                                    </label>
                                </section>

                                <section>
                                    <label class='control-label'>确认密码<span style="color: red;">*</span></label>
                                    <label class="input">
                                        <input type="password" id='confirm_password' name='confirm_password' placeholder='' class='span10' data-bind='value:SPassword' />
                                    </label>
                                </section>

                                

                            </fieldset>


                            <fieldset class="bg-success">
                                <section>
                                    <label class='control-label'>授权密码<span style="color: red;">*(长度为6-20)</span></label>
                                    <label class="input">
                                        <input type="password" id='txtbSOtherPassword' name='txtbSOtherPassword' placeholder='' class='span10' />
                                    </label>
                                </section>

                                <section>
                                    <label class='control-label'>确认授权密码<span style="color: red;">*</span></label>
                                    <label class="input">
                                        <input type="password" id='confirm_password2' name='confirm_password2' placeholder='' class='span10'  />
                                    </label>
                                </section>

                                
                            </fieldset>
                        </form>
                    </div>

                    <!--个人简介-->
                    <div class="tab-pane fade in " id="s4">
                        <div class="click2edit" style="height: 400px;"></div>
                    </div>




                </div>


            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">
                    取消</button>
                <button id="btnSaveOrUpdateModel" class="btn btn-primary" aria-hidden="true" data-bind=" click: onDataAddingOrUpdate">
                    确定</button>
            </div>
        </div>
        <!--end div content-->


    </div>
    <!--end of dailog  -->
</div>
<!--/详细SysUser对话框-->




<script type="text/javascript">

    pageSetUp();
    var pagefunction = function () {
        loadScript("/js/plugin/summernote/summernote.min.js", function () {
            loadScript(genRndURL("/PageJs/SysUser/SysUser.js"), function () {
                SysUserRunPage();
            });
        })
    };
    pagefunction();
</script>
